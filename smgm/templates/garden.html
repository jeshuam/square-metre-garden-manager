{% extends "_common.html" %}

{% block js %}
<script>
$(function() {
    // Update the number next to the range form fields (width/height).
    $('form input[type=range]').on('input', function() {
        $(this).next('output').text(this.value);
    });

    // On submit of the form.
    $('form#new-garden').submit(function(e) {
        e.preventDefault();

        // Validate the data.
        var $this = $(this);
        var data = {
            name: $this.find('input[name=name]').val(),
            width: $this.find('input[name=width]').val(),
            height: $this.find('input[name=height]').val(),
        }
        
        // Send the data.
        console.log(data);
        $.post({
            url: '/api/garden?' + $this.serialize(),
            data: data,
            dataType: 'json',
            success: function(resp) {
                console.log(resp);
            },

            error: function(resp, status, error) {
                console.log(resp.responseJSON.error);
            },
        });
    });
});
</script>
{% endblock %}

{% block content %}
    You have {{ gardens|length }} garden{% if gardens|length != 1 %}s{% endif %}.
    <ul>
        {% for garden in gardens %}
            <li>{{ garden.name }}, {{ garden.width }} x {{ garden.height }}</li>
        {% endfor %}
    </ul>

    <h1>New Garden</h1>
    <form id="new-garden" class="form-inline">
        <div class="form-group">
            <label for="name">Name</label>
            <input type="text" class="form-control" name="name" />
        </div>
        <div class="form-group">
            <label for="width">Width</label>
            <input type="range" min="1" max="16" value="4" class="form-control" name="width" />
            <output for="width">4</output>
        </div>
        <div class="form-group">
            <label for="name">Height</label>
            <input type="range" min="1" max="4" value="4" class="form-control" name="height" />
            <output for="height">4</output>
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
    </form>
{% endblock %}
